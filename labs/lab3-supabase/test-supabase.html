<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Supabase Edge Function</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }

        h1 {
            color: #3ecf8e;
        }

        input,
        button {
            padding: 12px;
            margin: 8px 0;
            width: 100%;
            box-sizing: border-box;
            border-radius: 8px;
            border: 1px solid #333;
        }

        input {
            background: #16213e;
            color: #fff;
        }

        button {
            background: #3ecf8e;
            color: #000;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background: #2eb87a;
        }

        #result {
            background: #16213e;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: monospace;
        }

        .error {
            color: #ff6b6b;
        }

        .success {
            color: #3ecf8e;
        }
    </style>
</head>

<body>
    <h1>üöÄ Test Supabase Edge Function</h1>

    <label>Function URL:</label>
    <input type="text" id="url" value="https://cxdvchtpdozfwlsxitse.supabase.co/functions/v1/dynamic-action">

    <label>Anon Key (Legacy JWT format):</label>
    <input type="text" id="anonKey" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...">

    <label>Your Name:</label>
    <input type="text" id="name" value="Virgi">

    <button onclick="testFunction()">üß™ Test Function</button>

    <div id="result">Response will appear here...</div>

    <script>
        async function testFunction() {
            const url = document.getElementById('url').value;
            const anonKey = document.getElementById('anonKey').value;
            const name = document.getElementById('name').value;
            const resultDiv = document.getElementById('result');

            if (!anonKey) {
                resultDiv.innerHTML = '<span class="error">‚ö†Ô∏è Please enter your Anon Key!</span>';
                return;
            }

            resultDiv.textContent = '‚è≥ Loading...';

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${anonKey}`
                    },
                    body: JSON.stringify({ name: name })
                });

                const data = await response.json();

                if (response.ok) {
                    resultDiv.innerHTML = '<span class="success">‚úÖ Success!</span>\n\n' + JSON.stringify(data, null, 2);
                } else {
                    resultDiv.innerHTML = '<span class="error">‚ùå Error:</span>\n\n' + JSON.stringify(data, null, 2);
                }
            } catch (error) {
                resultDiv.innerHTML = '<span class="error">‚ùå Request failed:</span>\n\n' + error.message;
            }
        }
    </script>
</body>

</html>